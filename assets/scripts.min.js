(function($) {
    $.fn.notification = function(options) {
        var defaultOnHide = function() {
            $(this).closest('.notification').slideUp(100).addClass('closed');
        };
        var uniqueId = Date.now();
        var settings = $.extend({
            onHide: defaultOnHide, // handler for clicking the hide icon
            exitable: true, // add close icon to hide notification?
            spacer: true // use a bottom spacer element to separate elements below?
        }, options);

        return this.each(function() {
            var _this = $(this);
            var className = _this.attr('class') != undefined ? _this.attr('class') : '';
            var html = _this.html();
            var id = uniqueId++;

            // replace the semantic <notification> element with a proper div.card element
            _this.replaceWith('<div id="' + id + '" class="card">' + html + '</div>');

            if (settings.exitable) {
                // add a close icon so users can hide the notification
                $('#' + id).prepend('<span class="icon icon-cross exit"></span>');
            }

            // wrap the div.card elemnt in proper bootstrap row and column divs
            $('#' + id).wrap('<div class="col-sm-12"></div>');
            $('#' + id).closest('.col-sm-12').wrap('<div class="row notification ' + className + '"></div>');

            if (settings.spacer) {
                // add a bottom spacer element to separate elements below
                $('#' + id).after('<div class="row spacer"></div>');
            }

            // add the click handler for the exit/close icon
            if (typeof settings.onHide == 'function') {
                $('.exit', '#' + id).on('click', settings.onHide);
            } else {
                $('.exit', '#' + id).on('click', defaultOnHide);
            }
        });
    };
}(jQuery));

$(document).ready(function() {
    $('.site-title').fitText(0.5, {maxFontSize: '100px'});

    $('notification').notification();

    $('form input, form textarea').on('focus', function() {
        $(this).siblings('label').fadeOut(100);
    }).on('blur', function() {
        if ($(this).val().length == 0) {
            $(this).siblings('label').fadeIn(100);
        }
    }).focus().blur();

    $('form').on('submit', function(e) {
        var valid = true; // states whether the submitted form has all valid fields

        // go through all required inputs and check for their validity
        $('*[required="required"]', this).each(function() {
            if ($(this).val() == '') {
                valid = false;
            }
        });

        $('.error-message', this).fadeOut(150);

        if (valid == false) {
            $('.error-message', this).fadeIn(150);
            return false;
        }
    });
});